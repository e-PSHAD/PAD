define("block_padplusvideocall/main",["exports","core/ajax","core/notification"],(function(_exports,_ajax,_notification){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.setupVideoCallBlock=_exports.requestVideoCall=_exports.handleVideoCallRequest=_exports.handleVideoCallFormRequest=void 0,_ajax=_interopRequireDefault(_ajax),_notification=_interopRequireDefault(_notification);_exports.handleVideoCallRequest=function(buttonId){var button=document.getElementById(buttonId);button.addEventListener("click",(function(e){var launchvideocallurl=button.getAttribute("href");requestVideoCall(e,launchvideocallurl)}))};_exports.handleVideoCallFormRequest=function(videocallform){videocallform.querySelector("input[type=submit]").addEventListener("click",(function(e){var formData=new FormData(videocallform),meetingname=formData.get("videocallname"),viewersid=formData.getAll("videocallviewers[]"),launchvideocallurl=videocallform.getAttribute("action");requestVideoCall(e,launchvideocallurl,viewersid,meetingname)}))};var requestVideoCall=function(e,launchvideocallurl,viewersid,meetingname){if(e.preventDefault(),viewersid){var viewersparam=viewersid.join(",");launchvideocallurl="".concat(launchvideocallurl,"&viewersid=").concat(viewersparam)}meetingname&&(launchvideocallurl="".concat(launchvideocallurl,"&name=").concat(meetingname)),window.open(launchvideocallurl)};_exports.requestVideoCall=requestVideoCall;function toggleDisplay(elementToHide){var elementToShow=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;elementToHide.classList.add("hidden"),elementToShow&&elementToShow.classList.remove("hidden")}function setInputValue(inputElement,value){inputElement.setAttribute("value",value),setTimeout((function(){inputElement.setSelectionRange(value.length,value.length),inputElement.focus(),inputElement.blur()}))}_exports.setupVideoCallBlock=function(root){var containerSharedLinks=root.querySelector("[data-container=padplusvideocall-shared-links]"),btnReset=root.querySelector("[data-action=reset"),btnsCopy=root.querySelectorAll("[data-action=copy]"),btnsRadio=root.querySelectorAll("[name=padplusvideocall-mode]"),moderatorInput=root.querySelector("[data-input=moderator]"),viewerInput=root.querySelector("[data-input=viewer]");btnsRadio.forEach((function(radio){var unplannedVideoCallGroup=root.querySelector("[data-container=padplusvideocall-unplanned]"),plannedVideoCallGroup=root.querySelector("[data-container=padplusvideocall-planned]");radio.addEventListener("change",(function(event){"planned"===event.target.value?toggleDisplay(unplannedVideoCallGroup,plannedVideoCallGroup):toggleDisplay(plannedVideoCallGroup,unplannedVideoCallGroup)}))}));var initialRequestContainer=root.querySelector("[data-container=padplusvideocall-initial-links]");root.querySelectorAll("[data-action=request-links]").forEach((function(button){button.addEventListener("click",(function(){return toggleDisplay(containerSharedLinks),function(root){var contextid=root.querySelector("[data-contextid]").getAttribute("data-contextid");return _ajax.default.call([{methodname:"block_padplusvideocall_generate_meeting_links",args:{contextid:contextid}}])[0].catch(_notification.default.exception)}(root).then((function(data){setInputValue(moderatorInput,data.moderatorurl),setInputValue(viewerInput,data.viewerurl),toggleDisplay(initialRequestContainer,containerSharedLinks)}))}))})),btnReset.addEventListener("click",(function(){toggleDisplay(containerSharedLinks,initialRequestContainer),moderatorInput.setAttribute("value",""),viewerInput.setAttribute("value","")})),btnsCopy.forEach((function(btnCopy){btnCopy.addEventListener("click",(function(){var user=btnCopy.getAttribute("data-input"),input=root.querySelector("[data-input=".concat(user,"]")),icon=root.querySelector("[data-icon=".concat(user,"]"));toggleDisplay(input,icon),setTimeout((function(){toggleDisplay(icon,input)}),1200),navigator.clipboard.writeText(input.value)}))}))}}));

//# sourceMappingURL=main.min.js.map